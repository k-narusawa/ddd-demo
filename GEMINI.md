# 実でDDDを参考に実装をしてみるプロジェクト

## 実装

### エンティティ

#### 概要

- エンティティには、`jakarta.persistence.Entity`の`@Entity`の付与が必須である。
- エンティティは、識別子を持つことが必須であり、識別子は値オブジェクトとして、`@EmbeddedId`の付与が必須である。
- エンティティは、識別子が同一であれば同一のエンティティとみなされる必要があるため、`equals`と
  `hashCode`のオーバーライドが必須である。
- エンティティは、`src/main/kotlin/dev/k_narusawa/ddd_demo/app/identity_access/domain/user/User.kt`
  を参考に作成すること。

### 値オブジェクト

- 値オブジェクトには、`jakarta.persistence.Embeddable`の`@Embeddable`の付与が必須である。
- data classを利用してクラスを作成する。
- 必要な条件があれば、initの中でrequireで値のチェックを行う。
- クラスのコンストラクタはprivateにして、プロパティは基本的には`value`
  のみとする。また、valueの可視性はprivateにし、専用のgetterを用意する。

## テスト

### 単体テスト

- テストはAAA(3A)パターンにしてください。AAAパターンとは以下の3つのパターンで構成されるテストケースになります。
    - 準備(Arrange)フェーズ
    - 実行(Act)フェーズ
    - 確認(Assert)フェーズ
- 単体テストにおいて同じフェーズを複数用意することはしないでください。 ※ 統合テストであれば問題ありません。
    - テストの実行時間が長くなるのを避けるためです。
- 単体テストにおいてif文の使用はしないでください。
- 実行フェーズのサイズは1行を超えないようにしてください。
- AAAのフェーズに後始末のフェーズ設けないでください。
- 各フェーズのコードの前にそのフェーズであることを示すコメントはしないでください。
    - 空行を挿入はしてください。
- テスト対象システムの変数名はsut(System Under Test)にしてください。

#### 集約・エンティティ

- 対象のエンティティの持つ振る舞いについてのテストを行う
- イベントの発行機能を行う場合にには、`@SpringBootTest`をクラスに付与して実施する

##### 実装例

- `dev.k_narusawa.ddd_demo.app.identity_access.domain.user.UserTest`を参考にしてください。

#### 値オブジェクト

- コンストラクタに同じ値を設定して作成したインスタンスが同一のものであることを確認する。
- 初期化に伴う以下のパターンをテストをこなうこと
    - 正常値テスト
    - 境界値テスト
    - 異常値テスト
    - 極端値テスト

##### 実装例

- `package dev.k_narusawa.ddd_demo.app.identity_access.domain.user.UsernameTest`を参考にしてください。
